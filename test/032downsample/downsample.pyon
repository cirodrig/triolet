
# Given a matrix, create a new matrix that's 1/4 the size and contains
# a low-resolution approximation of the input matrix.
# Each point in the output is the average of 4 neighboring points in the
# input matrix.
def downsample(mat):
	h = height(mat)
	w = width(mat)
	return __build__([(a + b + c + d) // 4 for (a,b,c,d)
		          in matrixiter(zip4(__iter__(mat[0:h:2, 0:w:2]),
					     __iter__(mat[1:h:2, 0:w:2]),
					     __iter__(mat[0:h:2, 1:w:2]),
					     __iter__(mat[1:h:2, 1:w:2])))])

export ccall downsample : matrix(int) -> matrix(int)
